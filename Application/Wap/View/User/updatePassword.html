<include file="Common:header"/>
<div style="background-color: white">
<div class="Huiform">
    <form action="{:U('Wap/User/save')}" method="post" name="myform" id="editform" enctype="multipart/form-data">
        <ul class="aui-list aui-form-list">
          
                <li class="aui-list-item aui-margin-b-10">
                    <div class="aui-list-item-inner">
                        <div class="aui-list-item-label">
                            新密码：
                        </div>
                        <div class="aui-list-item-input">
                    <input type="password" class="input-text" name="admin_password" placeholder="密码为3-16位字符串" datatype="*3-16" autocomplete="off" nullmsg="请设置密码！" errormsg="密码范围在3~16位之间！"/>
                        </div>
                    </div>
                </li>
                <li class="aui-list-item aui-margin-b-10">
                    <div class="aui-list-item-inner">
                        <div class="aui-list-item-label">
                            确认密码：
                        </div>
                        <div class="aui-list-item-input">
                    <input type="password" name="re_admin_repassword" class="input-text" placeholder="再次输入密码" datatype="*" autocomplete="off" ignore="ignore" recheck="admin_password" nullmsg="请再输入一次密码！" errormsg="您两次输入的账号密码不一致！" />
                        </div>
                    </div>
                </li>
        </ul>
            <div class="aui-margin-t-15 aui-padded-l-15 aui-padded-r-15 ">
                <buton class="aui-btn aui-btn-block aui-btn-outlined aui-btn-outlined2 aui-btn-sm " type="submit"  onclick="doUpdate()">修改保存</buton></div>
    </form>
</div>


<script type="text/javascript">
    function doUpdate(){
        var options = {
            url: "{:U('/user/updatePassword')}",
            dataType: 'json',
            beforeSubmit: function(){
                return true;
            },
            success: function (data) {
                if(data.msg=='succ'){
                    window.location.reload();
                }else{

                }
            }
        };
        $(".Huiform").Validform();
    }
    $(function(){
        $("#editform").Validform({
            tiptype:function(msg,o,cssctl){
                if(!o.obj.is("form")){
                    var objtip=o.obj.siblings(".Validform_checktip");
                    cssctl(objtip,o.type);
                    objtip.text(msg);
                }
            },
            ajaxPost:true,
            callback:function(data){
                if(data.status=="ok"){
                    alert('密码修改成功，请退出重新登录！');
                    top.location.href = "{:U('Wap/account/logout')}";
                }else{
                    alert(data.info);
                }
            }
        });
    });
</script>
</div>